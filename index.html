<!DOCTYPE html>
<!-- saved from url=(0039)https://1fran1946.github.io/js_nondraw/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/x-icon" href="data:image/gif;base64,R0lGODlhEAAQAPcAAAkYLAocNxQyWy1PkUtntS1etSRasxY/hRcwZSQtXDo1aD0yYjg3XQ8XLgcNGQ4WIwseOQ0mTyRNjl9wzImJ2ECA0WKb7Q5QqRtBhiM2b0RCf1FDhkJBahAbNQMLFQ8aLg4nTAgkUBpFfXmv6Zax4Umb2oTD8gA9jxVEfhY/eS84b0E5aUREbxkoSQYUKgwbMAkjSgEdSg1BfEGR3FeQ3SSG4W268gA4jgo4chJCfRcoXD06Y2ZVfCUxVQseNw8kPwYjTQIiXRJJiy5/11Oc8E6m7n/E9AJUsQc7eEV0qQktaDxAc2RVgCgyWhAlQhYwTggvXwEkYhVPkR5swjmR6nfS9IfK9GKs5q/H3a3I4ggybxolXC0pURQkRi5CWkBXcwo1bgM2dxtgqTuW7X3A9+D2+c3M87LL7ztzrkd5sHWQvI2Pwci026+wy4KauEpnhQw+egU8g2uo3dXo//T09//g+eng983g+rPC8r238Lev2oF9plRMbBcpTDdahTxjhRBEgw9JkYa86Ovz//Pu9f/y+fD1+sjr+KvA8LjQ8IagvkFSjCorYwciVTpolGV/mws5dAAtdRpmr4O98sXj8PX/+N/x95vV8Zy/3Mbf8/////Dr88rH0XeNrDpiiShLcQs0agMtan6hzbDJ9oe98XHP+nK78xJ22AE5igE7iRk9gGlwo19lgmB/qWGCnmx8k0lkicjW7IOkwhxRmihzyDqa737D9iR4zBJBhRNJkCVOllprpgogUCZHfgQwWxcxUwsjShMwYgAnYwU3fS9owzeS63W89gdRpBZEgk5nrHNyr25moUlUiElaig8vUBYrSQoiSAQdRgk3aCBFjkxvyi2L21uo7AAzhCtJin1pp/fP2rGFrHp2mDRJehAZNg4fOgwiQgohSh1BfVRLqb+T5V9/z3ia5hJGmD5YlWNNgcSdv4Roois1Yis+cAUULA8eNgoaMxEkSDJGg4l2xuvZ83J800RvyiFQnTVEd1NQfHBomFJPfzU1WEVHeBojQRkfNyH/C05FVFNDQVBFMi4wAwEAAAAh+QQFewCaACwAAAAAEAAQAAAI/wABQAABAwgUMHAAQQIFCxg0cPACRAgRI0iUMHECRQoVK1i0cPEESBAhQ4gUMXIESRIlS5g0cfIGTBgxY8iUMXMGTRo1a9i0cfMIUCBBgwgVMnQIUSJFixg1cvQKVChRo0iVMnUKVSpVq1i1cvUMWDBhw4gVM3YMWTJly5g1c/YOXDhx48iVM3cOXTp169i1c/cQYECBAwkWNHgQYUKFCxk2dPgSZEiRI0mWNHkSZUqVK1m2dPkUaFChQ4kWNXoUaVKlS5k2dfoWbFixY8mWNXsWbVq1a9m2dfsYcGDBgwkXNnwYcWLFixk3dvwadGjRo0mXNn0adWrVq1m3dv0ceCRw4cOJFzd+HHly5cuZN3f+Hnx48ePJlzd/Hn169evZt3f/BAQAOw==">


 
  
  <title>Non-draw</title>
  <style>
  *:not(hr), *::after, *::before {box-sizing: border-box;margin:0;padding:0;border:0}ul {list-style-type: none}
#i{padding: 0px 0;display: inline-block;background: linear-gradient(rgba(0,0,0,0.9), blue); 
text-align: center;
d0isplay:none;
}
.hide{display:none}

button {margin:2px; padding: 7px; display: inline-block; background:#ded;border:2px solid green; cursor: pointer;}
  .palet {display:flex;}
  .palet .calor {width:24px; height:24px;background: white;border:1px solid blue;}
#pascal{margin:10px;padding-left: 33px;border: 1px solid blue;width:fit-content;
position: relative;} 
.copybara {
transition: .5s ease-out;
position:absolute;
right:0px;
top: 2px;
b0ackground-color:yellow;
/* ******************* */
	background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAATCAIAAAAS8MqlAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAEsSURBVDhPnZC9TsMwFIV5RXZ4BF6BjpHYwgQrCxLpEDEQJ6FlohJMaQOoQvyUhZaGspHE8U+55lbErU0j9egosm/O5yN76zsvNrDCTg09Pb/oIdMLbK4Jtp3O5XrSjsE3iqI1ZI2lb5+9x2wuZRzHwIRhSAjRo7qX2iRAUsKiZegiCOxYOoK2KelP2rdjyP2esxCS3e6VBZNSSCG44CDEVLWaCdy6rvtH1thglPWGU5JMvJt3zB2cP+x7d1wIx3GAQa1icCpWMc4Qg4kacg7r2dcMbMEGr9n18CNIxmfLbXsn6e5xf/swgYkF04UYY7xiVVVRCqYlTFYxXb7v123te9V2ZGszDW8AIdVBS1oWpXLejMFvbGt5qm3HejfTiJlqxv4TBuxYozfC8uIHUDp6oFBQcH0AAAAASUVORK5CYII=);
	background-size: cover;
	cursor: pointer;
	width: 27px;
	height: 30px;
	margin-left:-27px;
	margin-bottom:20px;	
} 
.copybara:hover {transform: scale(1.1); border: 1px solid blue;}
#waw{display: block; height:32px; background: green;}
#waw:has(#curve:checked){background: red;} 
#curve{display:none;}
.doo{opacity: 0.5;}

.calor {position:relative}
.calor:last-child:after {position:absolute;display: block;content:'';width:30px;height:1px;
	background:black;top:9px;left:-3px;transform:rotate(45deg);}

.a:before {position:absolute;display: block;content:'';
	width:22px;height:8px;background:black;top:-8px;left:0px;}
.b:after {position:absolute;display: block;content:'';
	width:22px;height:8px;background:black;bottom:-8px;left:0px;}
	
#eon {position:fixed; width:100px; height:100px;
	top:50%; left:50%; transform: translate(-50%, -50%);
	d0isplay:block;display:none;z-index:555; 
	background:red; border:7px solid black;}
#wes div {border:2px solid blue;background:yellow;}	
		
  </style>  
</head>
<body text="black" bgcolor="white">
<script>
	const onmm=(event)=>{event.stopPropagation();}//onmm(event)
	const onmu=(event)=>{event.stopPropagation();}// onmd(event)
	const onfn=(event,n,m)=>{
		if(!curve.checked)onmm(event);//event.stopPropagation();
		if(document.getElementById('ute'))ute.remove();
		move=n;
		bok=m;	
		}
		
	const onmd0=(event,thix,n,m)=>{
		onfn(event,n,m);
		den0(thix);		
	}	
	const onmd1=(event,thix,n,m)=>{
		onfn(event,n,m);
		den1(thix);		
	}
	const onmd3=(event,thix,n,m)=>{
		onfn(event,n,m);
		den3(thix);
	}	
	const onmd4=(event,thix,n,m)=>{
		onfn(event,n,m);
		den4(thix,n);
	}	
</script>

<div id="eon" onclick="this.style.display='none';"></div>
<div id="i">
<svg id="svg" width="900" height="415" viewBox="0 0 900 415" fill="none" onmousedown="
if(curve.checked){
	const o={// вершина ломаной добавление/выделение
		x:stepx*(Math.round((event.clientX-i.offsetLeft
		+window.pageXOffset)/stepx)),
		y:stepy*(Math.round((event.clientY-i.offsetTop
		+window.pageYOffset)/stepy))
	};	

	// попал в заповедную зону
	let g=-1;// нарушитель
	for (let i=0;i&lt;a.length;i++)if(((a[i].x-o.x)*(a[i].x-o.x)+(a[i].y-o.y)*(a[i].y-o.y))&lt;160)g=i;
	if (g&gt;-1)
		{
			c=g;	
			vw();
		}
		else
		{
			a.push(o);
			c=a.length-1;
			bz.push(true);	
			vw();
		}
}
else{
	dawn[&#39;down&#39;]=true;
	dawn.x=stepx*(Math.floor((event.clientX-i.offsetLeft)/stepx)); 
	dawn.y=stepy*(Math.floor((event.clientY-i.offsetTop)/stepy));
	eff.setAttribute(&#39;x&#39;,dawn.x);
	eff.setAttribute(&#39;y&#39;,dawn.y);
	eff.classList.remove(&#39;hide&#39;);
}
" onmousemove="
if(curve.checked){}
else{
	if(dawn[&#39;down&#39;]){
	let x=stepx*(Math.floor((dawn.x-event.clientX+i.offsetLeft)/stepx));
	let y=stepy*(Math.floor((dawn.y-event.clientY+i.offsetTop)/stepy));
	eff.setAttribute(&#39;width&#39;,Math.abs(x));
	eff.setAttribute(&#39;height&#39;,Math.abs(y));
	dawn.w=Math.abs(x);
	dawn.h=Math.abs(y);
	}
}
" onmouseup="
if(curve.checked){}
else{
	dawn[&#39;down&#39;]=false;
	eff.classList.add(&#39;hide&#39;);
	let x=stepx*(Math.floor((dawn.x-event.clientX+i.offsetLeft)/stepx));
	let y=stepy*(Math.floor((dawn.y-event.clientY+i.offsetTop)/stepy));

	//console.log([&#39;up&#39;,dawn.x,dawn.y,Math.abs(x),Math.abs(y)].join(&#39;,&#39;));

	if(document.getElementById(&#39;ute&#39;))ute.remove();
	svg.innerHTML+=
		`&lt;rect id=&#39;ute&#39; x=&#39;`
		+dawn.x+`&#39; y=&#39;`
		+dawn.y+`&#39; width=&#39;`
		+dawn.w+`&#39; height=&#39;`
		+dawn.h+`&#39; stroke=&#39;red&#39; `
		+`stroke-width=&#39;1&#39; fill=&#39;none&#39;&gt;&lt;/rect&gt;`;
	move=0;
}
">
<style type="text/css">
.rect1, .polygon1 {stroke: blue;}
.txt1 {font-family: Arial; font-size: 12px; line-height: 0; fill:white;}
textPath {font-family: sans-serif; font-size: 16px;}
</style>
<rect class="x" x="0" y="0" width="900" height="415" fill="#ded"></rect>

<g id="grid1"><path d="M0 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M20 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M40 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M60 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M80 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M100 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M120 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M140 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M160 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M180 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M200 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M220 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M240 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M260 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M280 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M300 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M320 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M340 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M360 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M380 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M400 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M420 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M440 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M460 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M480 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M500 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M520 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M540 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M560 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M580 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M600 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M620 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M640 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M660 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M680 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M700 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M720 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M740 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M760 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M780 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M800 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M820 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M840 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M860 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M880 0 V420" stroke="gray" stroke-width="1"></path>
<path d="M0 0 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 20 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 40 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 60 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 80 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 100 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 120 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 140 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 160 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 180 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 200 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 220 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 240 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 260 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 280 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 300 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 320 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 340 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 360 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 380 H900" stroke="gray" stroke-width="1"></path>
<path d="M0 400 H900" stroke="gray" stroke-width="1"></path>
</g>




<ellipse class="x" cx="462.5" cy="302.5" rx="49.5" ry="10" stroke="blue" fill="cyan" opacity="1" stroke-width="1"></ellipse>
<g id="figs"></g>
<g id="gogo"></g>

<rect id="eff" class="hide" x="0" y="0" width="90" height="41" stroke="red" fill="none"></rect>


</svg>
</div><br>
<button onclick="but00()">rect</button>
<button onclick="but01()">round</button>
<button onclick="but05()">romb</button>
<!-- <label onclick="but2()">line /</label>
<label onclick="but3()">line \</label> -->
<button style="background: #def" onclick="but04();
a=[];c=-1;gogo.innerHTML=&#39;&#39;;
">polygon</button>
<button style="background: #def" onclick="but10();
a=[];c=-1;gogo.innerHTML=&#39;&#39;;
">bezie</button>
<button style="background: #def" onclick="a=[];c=-1;gogo.innerHTML=&#39;&#39;;// стирает путь">clear<br>path

</button><button onclick="grid()">grid</button>



<button onclick="but06()">male</button>
<button onclick="but07()">female</button>
<button onclick="but08()">fial</button>
<button onclick="but09()">runcap</button>
<button style="background: #dead" onclick="toBack(move)">toBack</button>
<button style="background: #dead" onclick="del()">×</button>
<button onclick="dev()">debug</button>

 <article class="palet" style="display: flex;align-items:center;">
	<div class="calor a" style="background: white;"></div>
	<div class="calor" style="background: red;"></div>
	<div class="calor b" style="background: black;"></div>
	<div class="calor" style="background: green;"></div>
	<div class="calor" style="background: yellow;"></div>
	<div class="calor" style="background: lime;"></div>
	<div class="calor" style="background: violet;"></div>
	<div class="calor" style="background: purple;"></div>
	<div class="calor" style="background: navy;"></div>
	<div class="calor" style="background: aqua;"></div><br>
	<div class="calor" style="background: blue;"></div>
	<div class="calor" style="background: gold;"></div>
	<div class="calor" style="background: teal;"></div>
	<div class="calor" style="background: olive;"></div>
	<div class="calor" style="background: maroon;"></div>
	<div class="calor" style="background: silver;"></div>
	<div class="calor" style="background: springgreen;"></div>
	<div class="calor" style="background: rgb(108, 117, 125);"></div>	
	<div class="calor" style="background: fuchsia;"></div>	
	<div class="calor" style="background: transparent;"></div>	
<div style="padding-left:8px;display:flex; flex-direction:column;">
<label><input type="radio" name="kore" id="inka" checked=""> fill</label>
<label><input type="radio" name="kore" id="paps"> strok</label>
</div>	
</article>

<label id="waw">
<input id="curve" type="checkbox" onchange="if(document.getElementById(&#39;ute&#39;))ute.remove();">
<!--  checked  -->
</label>
<div style=""></div>
<div id="pascal">

<div class="copybara" onclick="cpy(this.parentElement);">
</div>
</div>
<textarea id="cop" rows="1" cols="90" style="position:absolute; left:-9999px; color: white; background: green;" title="используется для копирования"></textarea>


<script>/*
<h1 id="h1"></h1>onchang
<h2 id="h2"></h2>
<h3 id="h3"></h3>
*/
let a=[]; // коорды в пикселях
let b=[]; // коорды в процентах
let bf=[]; // коорды в пикселях
let bz=[]; // сглаженность точки
let c=-1;  // курсор точек
let s;
let datax, datay;
let stepx=1,stepy=1;
let gxmi,gymi,gwidth,gheight;

let au=[];// dawno тека
let bok=0;
const cc=['white','red','black','green','yellow','lime',
'violet','purple','navy','aqua','blue','gold',
'teal','olive','maroon','silver','springgreen','#6c757d','fuchsia',
'transparent',
];
let move=null;
let n=0;
let ink=cc[0];//4//цвет заливки
let dawn={x:0,y:0,w:1,h:1};// знакоместо
let pap=cc[2];//18//'black';// цвет обводки
let aw=[];// брезентов поле под огурцы
//for (let i=0; i<(420/10|0); i++)
//	{aw.push([]); for (let j=0; j<(900/10|0); j++)aw[i].push(0)}
for (let i=0; i<(10); i++)
	{aw.push([]); for (let j=0; j<(10); j++)aw[i].push(0)}

const adi=()=>{// пиксели в проценты
	let xma,xmi,yma,ymi,dx,dy;
	let kx,ky;
	if (!a.length) return [];
	xma=a[0].x; yma=a[0].y;
	xmi=a[0].x; ymi=a[0].y;
	a.forEach(i=>{
		if(xma<i.x)xma=i.x;
		if(yma<i.y)yma=i.y;
		if(xmi>i.x)xmi=i.x;
		if(ymi>i.y)ymi=i.y;
		dx=xma-xmi;
		dy=yma-ymi;
		kx=dx/100;
		ky=dy/100;	
		});
	return a.map(i=>{return {
		x:Math.trunc((i.x-xmi)/kx),
		y:Math.trunc((i.y-ymi)/ky),
		}});
}

const fre=()=>{// пиксели не в проценты
	let xma,xmi,yma,ymi,dx,dy;
	let kx,ky;
	if (!a.length) return [];
	xma=a[0].x; yma=a[0].y;
	xmi=a[0].x; ymi=a[0].y;
	a.forEach(i=>{
		if(xma<i.x)xma=i.x;
		if(yma<i.y)yma=i.y;
		if(xmi>i.x)xmi=i.x;
		if(ymi>i.y)ymi=i.y;
		dx=xma-xmi;
		dy=yma-ymi;
		//kx=dx/100;
		//ky=dy/100;	
		});
	gxmi=xmi;
	gymi=ymi;
	gwidth=dx;
	gheight=dy;	
	return a.map(i=>{return {
		x:i.x-xmi,//Math.trunc())
		y:i.y-ymi,//Math.trunc())
		}});
}

const vw=()=>{ // рендеринг вершин ломаной
    b=adi();
	bf=fre();
	//h3.innerText=b.map(i=>i.x+' '+i.y).join(',');
	s=a.map((i,j)=>
	'<circle r="3" cx="'+(i.x)+
	'" cy="'+(i.y)+
	'" fill="'+((bz[j])?'red':'fuchsia')+'"/>'	
	).join('\n');
	gogo.innerHTML=	
	'<rect x="'+(a[c].x-5)+'" y="'+(a[c].y-5)+'" width="10" height="10" fill="none" stroke="red"/>'
	+s;	
}

//** увел  с https://prog-time.ru/kak-uznat-ton-tsveta-po-kodu-na-javascript/
function colorToRGBA(color) {// название цвета в rgb
    var cvs, ctx;
    cvs = document.createElement('canvas');
    cvs.height = 1;
    cvs.width = 1;
    ctx = cvs.getContext('2d');
    ctx.fillStyle = color;
    ctx.fillRect(0, 0, 1, 1);
    return ctx.getImageData(0, 0, 1, 1).data;
}

const brushcolor=(x)=>{
	let c=colorToRGBA(x.getAttribute('fill'));
	return `SetBrushColor(rgb(${c[0]},${c[1]},${c[2]}));`;
}
const strokecolor=(x)=>{
	let c=colorToRGBA(x.getAttribute('stroke'));
	if (!c) return '';
	return `SetPenColor(rgb(${c[0]},${c[1]},${c[2]}));`;
}

const pas=()=>{// pascalabc.net код 
	let bc,pc;
	pascal.innerHTML=
'uses graphABC;<br>'+	
'begin<br>'+
'	SetPenWidth(3);<br>'+
'	SetPenColor(clBlack);<br>'+	
	au.map((x,i)=>{		
		delete x['down'];
		let s='';
		let d;
		if(!x)return '';// нулевой эл всегда пустой
		if(x['x']<0)return '';// удаленая фигура х=-1
		d=document.getElementById('p'+i);//(i+1)//
		if(d){// полигон
			bc=brushcolor(d);
			//pc=strokecolor(d);
			s=d.getAttribute('d').replace(/[^\d-,]/g,'').split(',');
			let a=[];
			xx=0,yy=0;
			for(let j=0; j<s.length; j+=2){
				xx+=+s[j];
				yy+=+s[j+1];
				a.push('('+xx+','+yy+')');
			}	
			let e=bc+/*pc+*/'Polygon('+a.join(',')+');<br>';
			//let e=bc+'Polyline('+a.join(',')+','+a[0]+');<br>';
			return e;
		}
		d=document.getElementById('e'+i);////(i+1)
		if(d){//эллипс
			bc=brushcolor(d);
			let rx=+d.getAttribute('rx');
			let cx=+d.getAttribute('cx');
			let ry=+d.getAttribute('ry');
			let cy=+d.getAttribute('cy');					
			let e=bc+'Ellipse('+[(cx-rx),(cy-ry),(cx+rx),(cy+ry)].join(',')+');<br>';
			return e;
		}
		d=document.getElementById('r'+i);////(i+1)
		if(d){//прямоугольник
			bc=brushcolor(d);
			let rx=+d.getAttribute('x');
			let ry=+d.getAttribute('y');
			let cx=+d.getAttribute('width');
			let cy=+d.getAttribute('height');					
			let e=bc+'Rectangle('+[(rx),(ry),(cx+rx),(cy+ry)].join(',')+');<br>';
			return e;
		}
		d=document.getElementById('ll'+i);////(i+1)
		if(d){//line
			bc=strokecolor(d);
			let x1=+d.getAttribute('x1');
			let y1=+d.getAttribute('y1');
			let x2=+d.getAttribute('x2');
			let y2=+d.getAttribute('y2');					
			let e=bc
			+'Moveto('+x1+','+y1+'); '
			+'Lineto('+x2+','+y2+');<br>';
			return e;
		}		
		let m=[];
		for (const p in x)  m.push(`${p}: ${x[p]}`);	 
		return m.join('')+s+'<br>';})// end of map au
	.join('')
+'end.<br>'	;
	pascal.innerHTML+=
		'<div class="copybara" '
		+'onclick="cpy(this.parentElement);">'
		+'</div>';
}

//***************
jp=[...document.querySelectorAll('.calor')];
jp.forEach((x,i)=>{
	x.style.background=cc[i]; 
	x.addEventListener('click',(e)=>{
		
		
		if (inka.checked) 
			{jp.forEach(c=>{c.classList.remove('a')});ink=cc[i];e.target.classList.toggle('a')}
		if (paps.checked) 
			{jp.forEach(c=>{c.classList.remove('b')});pap=cc[i];e.target.classList.toggle('b')}
		
	});
});


//*******************************
const but00=()=>{// прямоугольник
	n++;
	if(document.getElementById('ute'))ute.remove();// id='mov'
	//svg.innerHTML+=
	figs.innerHTML+=
		'<rect class="fg"  id="r'
		+n+'" x="'
		+dawn.x+'" y="'
		+dawn.y+'" width="'
		+dawn.w+'" height="'
		+dawn.h+'" fill="'//transparent`
		+ink
		+'" stroke='+pap+' stroke-width="'+(ink=='transparent'?5:2)+'" '//
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd0(event,this,'+n+',0)"'
		+'></rect>';
	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	console.log(au);
	pas();
	move=n;
	}//

const but01=()=>{//circle
	n++;
	if(document.getElementById('ute'))ute.remove();
	//svg.innerHTML+=
	figs.innerHTML+=
		'<ellipse class="fg" id="e'+n+'" rx="'
		+(dawn.w/2)+'" ry="'
		+(dawn.h/2)+'" cx="'
		+(dawn.x+dawn.w/2)+'" cy="'
		+(dawn.y+dawn.h/2)+'" fill="'
		+ink+'"  stroke="'+pap+'" stroke-width="'+(ink=='transparent'?5:2)+'" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd1(event,this,'+n+',0)"'
		+'></ellipse>';
	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	pas();
	move=n;
	}

const but04=()=>{// полигон
	n++;
	let px,py;
	// прогон через проценты копит погрешности
	//let a10=b.map(i=>{return {x:(dawn.x+i.x*dawn.w/100),y:(dawn.y+i.y*dawn.h/100)}});
	if (!document.querySelector('ute')){//alert('need help')
		dawn.x=gxmi;
		dawn.y=gymi;
		dawn.w=gwidth;
		dawn.h=gheight;
		}
	let a10=bf.map(i=>{return {x:(dawn.x+i.x),y:(dawn.y+i.y)}});

	let a11=a10.map((j,k)=>{let o={x:(j.x-px),y:(j.y-py)};px=j.x;py=j.y;return (k===0)?j:o});
	let a12=a11.map(v=>(v.x|0)+','+(v.y|0)).join(',');
	//console.log(a12);
	if(document.getElementById('ute'))ute.remove();
	//svg.innerHTML+=
	//if(n===6){}
	if(a10.length>2){
	figs.innerHTML+=
		'<path class="fg" id="p'+n+'" d="m'
		+a12
		+'z" fill="'
		+ink+'"  '
		+((n!=6)?'stroke='+pap+' stroke-width="'+(ink=='transparent'?5:2)+'" ':'stroke="red" stroke-width="'+(ink=='transparent'?5:2)+'" ')
		
		+' data-x="'
		+(a11[0].x|0)
		+'" data-y="'
		+(a11[0].y|0)+'" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'	
		+' onmousedown="onmd4(event,this,'+n+',0)"'
		+'></path>\r\n';//</ellipse>`;
		}
	if(a10.length===2){//alert('line')
	
	let 
	x01=a11[0].x|0,
	y01=a11[0].y|0,
	x02=(a11[0].x|0)+(a11[1].x|0),
	y02=(a11[0].y|0)+(a11[1].y|0),
	p01={x:x01,y:y01}, p02={x:x02,y:y02};
	
	if((x01==x02)&&(y01>y02))[p01,p02]=[p02,p01];//деструктуризация
	if((y01==y02)&&(x01>x02))[p01,p02]=[p02,p01];
	figs.innerHTML+=
		'<line  class="fg" id="ll'+n+'"  x1="'
		+p01.x+'" y1="'//		(a11[0].x|0)
		+p01.y+'" x2="'//		(a11[0].y|0)
		+p02.x+'" y2="'//		((a11[0].x|0)+(a11[1].x|0))
		+p02.y+'" stroke="'//	((a11[0].y|0)+(a11[1].y|0))
		+pap+'" stroke-linecap="square" stroke-width="5" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd3(event,this,'+n+',0)"'

		+'></line>';		
		}	
	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	pas();
	move=n;// dont work
	}


const but05=()=>{// ромб
	n++;
	let px,py;
	b=[{x:0,y:50},{x:50,y:0},{x:100,y:50},{x:50,y:100}];
	let a10=b.map(i=>{
		return {
			x:(dawn.x+i.x*dawn.w/100),
			y:(dawn.y+i.y*dawn.h/100)
		}});
	let a11=a10.map((j,k)=>{
		let o={x:(j.x-px),y:(j.y-py)};
		px=j.x;
		py=j.y;
		return (k===0)?j:o}
		);
	let a12=a11.map(v=>(v.x|0)+','+(v.y|0)).join(',');

	if(document.getElementById('ute'))ute.remove();
	figs.innerHTML+=
		'<path class="fg" id="p'+n+'" d="m'
		+a12
		+'z" fill="'
		+ink+'"  stroke="'+pap+'" stroke-width="'+(ink=='transparent'?5:2)+'" '
		+' data-x="'
		+(a11[0].x|0)
		+'" data-y="'
		+(a11[0].y|0)+'" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd4(event,this,'+n+',0)"'

		+'></path>\r\n';//</ellipse>`;
	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	pas();
	move=n;
	}
	

const but06=()=>{// самец
	n++;
	let px,py;
	b=[{x:0,y:0},{x:100,y:0},{x:50,y:100}];	
	let a10=b.map(i=>{
		return {
			x:(dawn.x+i.x*dawn.w/100),
			y:(dawn.y+i.y*dawn.h/100)
		}});
	let a11=a10.map((j,k)=>{
		let o={x:(j.x-px),y:(j.y-py)};
		px=j.x;
		py=j.y;
		return (k===0)?j:o}
		);
	let a12=a11.map(v=>(v.x|0)+','+(v.y|0)).join(',');

	if(document.getElementById('ute'))ute.remove();
	figs.innerHTML+=
		'<path class="fg" id="p'+n+'" d="m'
		+a12
		+'z" fill="'
		+ink+'"  stroke="'+pap+'" stroke-width="'+(ink=='transparent'?5:2)+'" '
		+' data-x="'
		+(a11[0].x|0)
		+'" data-y="'
		+(a11[0].y|0)+'" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd4(event,this,'+n+',0)"'

		+'></path>\r\n';//</ellipse>`;
	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	pas();
	move=n;
	}	
	
	

	
const but07=()=>{// самка
	n++;
	let px,py;
	b=[{x:50,y:0},{x:100,y:100},{x:0,y:100}];	
	let a10=b.map(i=>{
		return {
			x:(dawn.x+i.x*dawn.w/100),
			y:(dawn.y+i.y*dawn.h/100)
		}});
	let a11=a10.map((j,k)=>{
		let o={x:(j.x-px),y:(j.y-py)};
		px=j.x;
		py=j.y;
		return (k===0)?j:o}
		);
	let a12=a11.map(v=>(v.x|0)+','+(v.y|0)).join(',');

	if(document.getElementById('ute'))ute.remove();
	figs.innerHTML+=
		'<path class="fg" id="p'+n+'" d="m'
		+a12
		+'z" fill="'
		+ink+'"  stroke='+pap+' stroke-width="'+(ink=='transparent'?5:2)+'" '
		+' data-x="'
		+(a11[0].x|0)
		+'" data-y="'
		+(a11[0].y|0)+'" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd4(event,this,'+n+',0)"'

		+'></path>\r\n';//</ellipse>`;
	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	pas();
	move=n;
	}	
	
const but08=()=>{// фиал
	n++;
	let px,py;
	b=[
{x:67,y:100,c:false},	
	
{x:-34,y:0,c:false},//{x:34,y:100,c:false},
{x:18,y:-35,c:true},  
{x:-80,y:-35,c:false},  
{x:-32,y:-100,c:false}, 
   
{x:16,y:13,c:true},    
{x:32,y:13,c:false},     
{x:48,y:13,c:false},     
{x:16,y:0,c:true}, 
{x:32,y:0,c:false},
       
{x:50,y:-14,c:false},      
{x:46,y:64,c:true}, //16   
{x:-50,y:64,c:false},     
{x:-32,y:100,c:false},		
	];	
	let tx=dawn.x, ty=dawn.y;
	let a10=b.map((i,j)=>{
		return {
			x:(((j)?0:tx)+i.x*dawn.w/100),//dawn.x+
			y:(((j)?0:ty)+i.y*dawn.h/100),//dawn.y+
			c: i.c,
		}});
	let a11=a10.map((j,k)=>{
		//let o={x:(j.x-px),y:(j.y-py),c:j.c};
		let o={x:(j.x),y:(j.y),c:j.c};
		px=j.x;
		py=j.y;
		return (k===0)?j:o}
		);
	a11[5]['y']=11;	a11[6]['y']=11;a11[7]['y']=11;
	a11[8]['y']=0;a11[9]['y']=0;a11[10]['y']=-12;
	let a12=a11.map(v=>((v.c)?'c':'')+(v.x|0)+','+(v.y|0)).join(',');

	if(document.getElementById('ute'))ute.remove();
	//svg.innerHTML+=
	figs.innerHTML+=
		'<path class="fg" id="p`+n+`" d="m'
		+a12
		+'z" fill="'
		+ink+'"  stroke='+pap+' stroke-width="'+(ink=='transparent'?5:2)+'" '
		+' data-x="'
		+(a11[0].x|0)
		+'" data-y="'
		+(a11[0].y|0)+'" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd4(event,this,'+n+',0)"'
		+'></path>\r\n';//</ellipse>`;
	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	pas();
	move=n;
	}	


const but09=()=>{// чаша
	n++;
	let px,py;
	b=[
{x:50,y:100,c:false},	
	
{x:-10,y:-10,c:false},//{x:34,y:100,c:false},
{x:-35,y:-35,c:true},  
{x:-70,y:-35,c:false},  //-80
{x:-40,y:-90,c:false}, 
   
{x:16,y:13,c:true},    
{x:32,y:13,c:false},     
{x:50,y:13,c:false},     
{x:16,y:0,c:true}, 
{x:32,y:0,c:false},
       
{x:50,y:-14,c:false},      
{x:20,y:55,c:true}, //30  
{x:-5,y:55,c:false},     
{x:-40,y:90,c:false},		
	];	
	let tx=dawn.x, ty=dawn.y;
	let a10=b.map((i,j)=>{
		return {
			x:(((j)?0:tx)+i.x*dawn.w/100),//dawn.x+
			y:(((j)?0:ty)+i.y*dawn.h/100),//dawn.y+
			c: i.c,
		}});
	let a11=a10.map((j,k)=>{
		let o={x:(j.x),y:(j.y),c:j.c};
		px=j.x;
		py=j.y;
		return (k===0)?j:o}
		);
	a11[5]['y']=11;	a11[6]['y']=11;a11[7]['y']=11;
	a11[8]['y']=0;a11[9]['y']=0;a11[10]['y']=-12;
	let a12=a11.map(v=>((v.c)?'c':'')+(v.x|0)+','+(v.y|0)).join(',');

	if(document.getElementById('ute'))ute.remove();
	figs.innerHTML+=
		'<path class="fg" id="p'+n+'" d="m'
		+a12
		+'z" fill="'
		+ink+'"  stroke='+pap+' stroke-width="'+(ink=='transparent'?5:2)+'" '
		+' data-x="'
		+(a11[0].x|0)
		+'" data-y="'
		+(a11[0].y|0)+'" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd4(event,this,'+n+',0)"'
		+'></path>\r\n';//
	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	pas();
	move=n;
	}	
	
const but10=()=>{// безье
	n++;
	let px,py;
	// прогон через проценты копит погрешности
	//let a10=b.map(i=>{return {x:(dawn.x+i.x*dawn.w/100),y:(dawn.y+i.y*dawn.h/100)}});
	if (!document.querySelector('ute')){//alert('need help')
		dawn.x=gxmi;
		dawn.y=gymi;
		dawn.w=gwidth;
		dawn.h=gheight;
		}
	let a10=bf.map(i=>{return {x:(dawn.x+i.x),y:(dawn.y+i.y)}});	
	
	//alert(a10.length);
if (a10.length%3===0){
//alert('lox');
a10.push(a10[0]);
}	
	
	let a11=a10.map((j,k)=>{let o={x:(j.x-px),y:(j.y-py)};px=j.x;py=j.y;return (k===0)?j:o});
	px=a10[0].x;py=a10[0].y;
	//let a14=a10.map((j,k)=>{let o={x:(px-j.x),y:(py-j.y)};return (k===0)?j:o});	//
	let a14=a10.map((j,k)=>{

		let o={x:(j.x-px),y:(j.y-py)};
		if(k%3===0){px=j.x;py=j.y;}	
			console.log([px,py]);
		return (k===0)?j:o});	//	
	let a12=a14.map(v=>(v.x|0)+','+(v.y|0)).join(',');
	let a13=a12.split(/,/g)[0]+','+a12.split(/,/g)[1]+', c'+a12.split(/,/g).slice(2).join(',');
	//alert(a12);
	//alert(a13);
	//console.log(a12);
	if(document.getElementById('ute'))ute.remove();
	//svg.innerHTML+=
	if(a10.length>2){
	figs.innerHTML+=
	
		'<path class="fg" id="p'+n+'" d="m'		
		+a13
		+'z" fill="'		
		+ink+'"  '
		+'stroke="'+pap+'" stroke-width="'+(ink=='transparent'?5:2)+'" '				
		+' data-x="'
		+(a11[0].x|0)
		+'" data-y="'
		+(a11[0].y|0)+'" '
		+' onmouseup="onmu(event)" onmousemove="onmm(event)"'
		+' onmousedown="onmd4(event,this,'+n+',0)"'
		+'></path>\r\n';//</ellipse>`;
		}
		

	au[n]={};for (let key in dawn){au[n][key] = dawn[key];}
	bok=0;
	pas();
	move=n;// dont work
	}

		

const grid=()=>{// создает сетку

//return 0;
	
	let xx=0;
	let dx, dy;
	if(dawn.x+dawn.y){return 0; dx=dawn.w; dy=dawn.h;}else{dx=10; dy=10;}
	
	grid1.innerHTML='';
	while(xx<900){
	grid1.innerHTML+=
	'<path d="M'+xx+' 0 V420" stroke="gray" stroke-width="1"></path>\r\n';
	xx+=2*dx;}
	let yy=0;
	while(yy<420){
	grid1.innerHTML+=
	'<path d="M0 '+yy+' H900" stroke="gray" stroke-width="1"></path>\r\n';
	yy+=2*dy;}
	stepx=dx; stepy=dy;
}

const del=()=>{
	if(move){
		let a=[...document.querySelectorAll('.fg')];
		//**дамнотека
		au[move]['x']=-1;
		console.log(au[move]);//
		//***свг
		a[move-1].style.display='none';
		//***
		move=0;
	}
	bok=0;
	pas();
}

//***********************************
const den0=(n)=>{ // квадрат
dawn.x=n.getAttribute('x');
dawn.y=n.getAttribute('y');
dawn.w=n.getAttribute('width');
dawn.h=n.getAttribute('height');
}
const den1=(n)=>{ // круг
dawn.x=n.getAttribute('cx')-n.getAttribute('rx');
dawn.y=n.getAttribute('cy')-n.getAttribute('ry');
dawn.w=2*n.getAttribute('rx');
dawn.h=2*n.getAttribute('ry');
}

const den3=(n)=>{// линия
dawn.x=n.getAttribute('x1');
dawn.y=n.getAttribute('y1');
dawn.w=n.getAttribute('x2')+n.getAttribute('x1');
dawn.h=n.getAttribute('y2')+n.getAttribute('y1');
}
const den4=(n)=>{// полигон
dawn={};for (let key in au[n]){dawn[key] = au[n][key];}
}
 //********************* выбранная точка перемещается курсорными клавишами
 document.addEventListener('keydown', (e) => {// ←↑↓→
	// сканирование клавы 
	let hx,hy;
	//h1.innerText=move;
	if(move)
		if(document.getElementById('ute'))
			ute.remove();
	switch(e.key) {//
		case 'ArrowDown': //↓
			if(curve.checked){
				if(c+1){a[c].y+=stepy; vw();}// точки ломаной			
			}
			else{
			hx=0;hy=stepy;
			switch (bok){// подвижная грань
				case 2: dawn.h=+dawn.h+stepy; break;//низ
				case 4: dawn.y=+dawn.y+stepy; 
						dawn.h=+dawn.h-stepy; 
						break;//верх
				case 0: dawn.y=+dawn.y+stepy; break;//все
				}			
				}
				e.preventDefault();
				break;
				
		
		case 'ArrowUp': //↑
			if(curve.checked){
				if(c+1){a[c].y-=stepy; vw();}
			}
			else{
			hx=0;hy=-stepy;
			switch (bok){
				case 2: dawn.h=+dawn.h-stepy; break;//низ
				case 4: dawn.y=+dawn.y-stepy; dawn.h=+dawn.h+stepy; break;//верх
				case 0: dawn.y=+dawn.y-stepy; break;//все
				}					
				}
				e.preventDefault();
				break;
						  
		case 'ArrowRight': //→
			if(curve.checked){
				if(c+1){a[c].x+=stepx; vw();}
			}
			else{
			hx=stepx;hy=0;
			switch (bok){
				case 1: dawn.w=+dawn.w+stepx; break;//правая
				case 3: dawn.x=+dawn.x+stepx; dawn.w=+dawn.w-stepx; break;//левая
				case 0: dawn.x=+dawn.x+stepx; break;//все
				}
				}
				e.preventDefault();
				break;
					
		case 'ArrowLeft': //←
			if(curve.checked){
				if(c+1){a[c].x-=stepx;	vw();}
			}
			else{
			hx=-stepx;hy=0;
			switch (bok){
				case 1: dawn.w=+dawn.w-stepx; break;
				case 3: dawn.x=+dawn.x-stepx; dawn.w=+dawn.w+stepx; break;
				case 0: dawn.x=+dawn.x-stepx; break;
				}
				}
				e.preventDefault();
				break;
		case ' ': //but01();break;//	alert('space')			
		         curve.click();

		case '0': if(!curve.checked){bok++;bok=bok%5;
			/*switch (bok){// подвижная грань
				case 1: hx=stepx; hy=0; break;
				case 2: hx=0; hy=stepy; break;//низ
				case 3: hx=-stepx; hy=0; break;
				case 4: hx=0; hy=-stepy; break;//верх
				}*/
			switch (bok){// подвижная грань
				case 0: hx=0; hy=0; break;
				case 1: hx=0; hy=0; break;
				case 2: hx=0; hy=0; break;//низ
				case 3: hx=0; hy=0; break;
				case 4: hx=0; hy=0; break;//верх
				}				
		}// numpad0	, 0	
		default: break;
	}// switch
	//h2.innerText=bok; // перемещаемая грань знакоместа


	if(document.getElementById('ute')){	
		ute.setAttribute('x',dawn.x);
		ute.setAttribute('y',dawn.y);	
		ute.setAttribute('width',dawn.w);
		ute.setAttribute('height',dawn.h);
		pas();
		return; 
	}	

	let b;// искомый элемент
	b=document.querySelector('#r'+move);// квадрат
	if (b)
		{	
		b.setAttribute('x',dawn.x);
		b.setAttribute('y',dawn.y);	
		b.setAttribute('width',dawn.w);
		b.setAttribute('height',dawn.h);
		pas();
		return;
		}
	b=document.querySelector('#e'+move);// круг
	if (b)
		{	
		b.setAttribute('cx',dawn.x+dawn.w/2);
		b.setAttribute('cy',dawn.y+dawn.h/2);	
		b.setAttribute('rx',dawn.w/2);
		b.setAttribute('ry',dawn.h/2);
		pas();
		return;
		}
	b=document.querySelector('#p'+move);// полигон
	if (b)
		{	
		datax=+b.dataset.x+hx;
		datay=+b.dataset.y+hy;
		if(isNaN(datax)){return;}//alert('nan');
		b.dataset.x=datax;// иногда масштбирование помещает сюда NaN
		b.dataset.y=datay;			
		let s=b.getAttribute('d').replace(/(m\d+,\d+)(.+)/,'$2');
		b.setAttribute('d','m'+datax+','+datay+s);
		pas();
		return;
		}
	});
//**************************
const toBack=()=>{
	b=document.querySelector('#r'+move)||// квадрат	
		document.querySelector('#e'+move)||// круг	
		document.querySelector('#p'+move);// полигон
//	if (b){figs.append(b)}
	if (b){figs.prepend(b)}	
}		
//**************************

const cpy=x=>{ // копирование в буфер обмена
	const cop=document.querySelector('#cop');
	cop.value=pascal.innerText;
	cop.select();
	document.execCommand('copy');
} 
//*****************************************************************//
const dev=()=>{
	aw=[];// брезентов поле под огурцы
	for (let i=0; i<(420/10|0); i++)
		{aw.push([]); for (let j=0; j<(900/10|0); j++)aw[i].push(0)}
	//alert([aw.length,aw[0].length].join(' '));	
	/*
	for (let i=0; i<(10); i++)
		{aw.push([]); for (let j=0; j<(10); j++)aw[i].push(0)}
	*/
	let p=0;
	const cry=y=>aw[y].map(c=>+y).join('.');
	const sry=y=>aw[y].join('.');
	const crx=x=>aw.map(c=>+x).join('.');
	const srx=x=>aw.map(c=>c[x]).join('.');	
	const poy=(y,s)=>{aw[y]=aw[y].map((c,i)=>+s.split('.')[i]);}
	const pox=(x,s)=>{aw.forEach((c,i)=>{aw[i][x]=+s.split('.')[i]});}	
	//********************+
	
	const line2=(c,p)=>{	
			let x1=c.getAttribute('x1')/10|0;
			let y1=c.getAttribute('y1')/10|0;
			let x2=c.getAttribute('x2')/10|0;//x1+
			let y2=c.getAttribute('y2')/10|0;//y1+		
	//------------------проверь что справва и слева один цвет
	for(let i=x1; i<x2; i++){if(aw[y1][i]!==aw[y1-1][i])return p}//
	for(let j=y1; j<y2; j++){if(aw[j][x1]!==aw[j][x1-1])return p}//
	//------------------
			p++;
		
			let c1=aw[y1][x1];//жертвацвет
			if(y1==y2){
				//alert('liiin');
				for(let i=x1; i<x2; i++){
					if(aw[y1][i]==c1){
						let j=y1;
						while((j<aw.length)&&(aw[j][i]==c1)){//
							aw[j][i]=p;
							j++;						
							}						
						}
						else{
						let j=y1;
						c1=aw[y1][i];
						p++;
						while((j<aw.length)&&(aw[j][i]==c1)){//&&j<aw.length
							aw[j][i]=p;
							j++
							}
						}
					}
				}
			
			if(x1==x2){
				//alert('liiin');
				for(let i=y1; i<y2; i++){
					if(aw[i][x1]==c1){
						let j=x1;
						while((j<aw[0].length)&&(aw[i][j]==c1)){//(j<aw[0].length)&&
							aw[i][j]=p;
							j++;						
							}						
						}
						else{
						let j=x1;
						c1=aw[i][x1];
						p++;
						while((j<aw[0].length)&&(aw[i][j]==c1)){//&&j<aw[0].length
							aw[i][j]=p;
							j++
							}
						}
					}
				}	
	return p;
	}
	//---------------------------
	aw=aw.map(y=>y.map(x=>0));	// массив обнуляется
	let f=[...document.querySelectorAll('#figs rect, #figs line')];
	
	f.forEach(c=>{
	//alert(c.tagName)
	switch(c.tagName){
		case 'rect':{
			//alert('квадр');
			if (c.style.fill!=='transparent'){
			//alert('plot');
			p++;
			let xx=c.getAttribute('x')/10|0;//alert(xx);
			let ww=xx+c.getAttribute('width')/10|0;//alert(ww);
			let yy=c.getAttribute('y')/10|0;//alert(yy);
			let hh=yy+c.getAttribute('height')/10|0;//alert(hh);
			
			for(let x=xx; x<ww; x++)
				for(let y=yy; y<hh; y++){
					aw[y][x]=p;
					//console.log([x,y].join(' '));
					}
			}else{}
			break;
			}
		case 'line':{
			//alert('линия');
			p=line2(c,p);
			break;
			}//line
		}
	});//f.forEach

//alert(aw[5].join(''));	
	//alert(sry(0));alert(i);
	//aw.forEach((c,i)=>{alert(sry(i))}); 
	
	/**/
	/**/
	let sn='';//подвижки
	sn=cry(0);
	let nky=0;
	aw.forEach((c,i)=>{let d=sry(i); 
		//if(!i)alert([d.length,aw.length,aw[0].length,].join(' '));
		if (d!==sn){ poy(nky,d); nky++; sn=d;}
		});
		
//aw=aw.slice(0,nky-1);// обрезка 101	-1
//alert([nky-1,'рядов'].join(' '));
//alert(aw[0].join(''));
	//aw=aw.map((c,i)=>{if (i>=nk){ return c.map(u=>0)} else return c});
//aw=aw.map((c,i)=>(i<nky)?c.map(u=>u):c.map(u=>0));//ЧЖАТИЕ
	//aw=aw.map((c,i)=>(i<nk)?c.map(u=>9):c.map(u=>8));
	//poy(0,'5.5.5.5.5.5.5.5.5.5');
	//alert([aw.length,aw[0].length].join(' '));
	//alert(f.length);
	//alert(sry(6));
	//console.log(aw);
	//pox(8,crx(4));
	//let aww=aw;//.slice(0,nky);
	//alert(nky);
	/**/
	//alert(crx(7));
	//alert(srx(0));
	/**/
	sn=crx(0);// еще подвижки
	let nk=0;	
	aw[0].forEach((c,i)=>{		
		let d=srx(i); 
		//if(!i)alert([d.length,aw.length,aw[0].length].join(' '));
		if (d!==sn){ pox(nk,d); nk++; sn=d;}
		});	
//alert(aw[0].join(''));		
//alert([nk-1,'столбцов'].join(' '));		
//aw=aw.map(c=>c.map((u,i)=>(i<nk)?u:0));	// сжаттие
	//aw=aw.map(c=>c.map((u,i)=>9));
	//console.log(aww);
aw=aw.map(c=>c.slice(0,nk-1));// обрезка 101
	
aw=aw.slice(0,nky-1);// обрезка 101
	//console.log(aw);
	
	
	let s=tbl(aw);
	
	pascal.innerHTML='<br>'+s.replaceAll('<','&lt;').replaceAll('>','&gt;').replaceAll('\r\n','<br>');
	pascal.innerHTML+=
		'<div class="copybara" '
		+'onclick="cpy(this.parentElement);">'
		+'</div>';
		
	console.log(s);//	
}
//------------------------------------------
const tbl=a=>{
	const cc=['white','yellow','tomato','violet','lime','blue','black','navy','teal','red','green'];
	if(!a.length)alert('empty');
	console.log(a);
	eon.style.display='block';
	let d='<div></div>'.repeat(a.length*a[0].length);
	d='';//a[j][i]
	a.forEach(i=>i.forEach(j=>d+='<div style="background:'+cc[j%10]+'"></div>'));

	
	eon.innerHTML='<div id="wes"   '+
	'style="display:grid;height:100%;'+
	'background:lime;padding:2px;'+
	'grid-template-rows:'+'1fr '.repeat(a.length)+';'+
	'grid-template-columns:'+'1fr '.repeat(a[0].length)+';'+
	'">'+d+'</div>';
	let s='';
	for (let i=0; i<a.length; i++){
		s+='<tr>';
		for (let j=0; j<a[0].length; j++){
			let v=a[i][j];// жертвацвет
			if(!v)continue;
			let ii=i, jj=j, jjj;
			while ((ii<a.length)&&(a[ii][jj]==v)){
				while ((jj<a[0].length)&&(a[ii][jj]==v)){
					a[ii][jj]=0;					
					jj++
					}
				ii++;
				jjj=jj;
				jj=j;
				}
			s+='<td'+
				(' rowspan="'+(ii-i)+'" colspan="'+(jjj-j)+'"')
				.replace(' rowspan="1"','')
				.replace(' colspan="1"','')+'></td>';	
			}
		s+='</tr>\r\n';
		}    
	return '<table>\r\n'+s+'</table>';
	}

//------------------------------------------
grid();
</script>   

</body></html>